---
defaults:
  bin_dir: $HOME/bin
  opt_dir: /opt
  tmp_dir: /tmp
  pkg_dir: /opt/_packages
  ver:
    type: cmd
    name: "{{ tool.name }} --version"
    regex: '\d.*'
  git:
    look_up: releases
    tag: latest
    custom: no
    token_env: GITHUB_TOKEN

tools:
  - name: bicep
    type: git
    repo: Azure/bicep
    incl:
      - linux-x64
      - bicep
    inst:
      - install "{{ tool.pkg_dir }}/{{ tool.pkg_name }}" "{{ tool.bin_dir }}/{{ tool.name }}"
    ver:
      regex: 'version (.*?) \('
  - name: peazip
    type: git
    repo: peazip/PeaZip
    incl:
      - LINUX.Qt6-1.x86_64
      - rpm
  - name: sourcegit
    type: git
    repo: sourcegit-scm/sourcegit
    incl:
      - x86_64
      - rpm
  - name: rustdesk
    type: git
    repo: rustdesk/rustdesk
    incl:
      - x86_64
      - rpm
    excl:
      - suse
  - name: pingnoo
    type: git
    repo: nedrysoft/pingnoo
    incl:
      - fc33
      - x86_64
      - rpm
  - name: rclone
    type: git
    repo: rclone/rclone
    incl:
      - linux-amd64
      - rpm
  - name: displaylink
    type: git
    repo: displaylink-rpm/displaylink-rpm
    incl:
      - fedora-43
      - x86_64
      - rpm
  - name: pdfsam
    type: git
    repo: torakiki/pdfsam
    incl:
      - linux
      - tar.gz
    excl:
      - asc
    inst:
      - mkdir -p "{{ tool.opt_dir }}/{{ tool.name }}"
      - sudo rm -rf "{{ tool.opt_dir }}/{{ tool.name }}/*"
      - tar --strip-components=1 -C "{{ tool.opt_dir }}/{{ tool.name }}" -xvf "{{ tool.pkg_dir }}/{{ tool.pkg_name }}"
    ver:
      name: "ls -1 {{ tool.opt_dir }}/{{ tool.name }}/lib/"
      regex: 'pdfsam-basic-(.*?).jar'
  - name: markdown2confluence
    type: git
    repo: justmiles/go-markdown2confluence
    incl:
      - linux_x86_64
      - tar.gz
    inst:
      - tar -C "{{ tool.bin_dir }}" -xvf "{{ tool.pkg_dir }}/{{ tool.pkg_name }}" "{{ tool.name }}"
    ver:
      regex: 'markdown2confluence (.*)'
  - name: curl-impersonate
    type: git
    repo: lexiforest/curl-impersonate
    incl:
      - x86_64-linux-gnu
      - tar.gz
    excl:
      - libcurl
    inst:
      - tar -C "{{ tool.bin_dir }}" -xvf "{{ tool.pkg_dir }}/{{ tool.pkg_name }}" "{{ tool.name }}" curl_chrome136 curl_firefox135
      - mv "{{ tool.bin_dir }}/curl_chrome136" "{{ tool.bin_dir }}/curl-ch"
      - mv "{{ tool.bin_dir }}/curl_firefox135" "{{ tool.bin_dir }}/curl-fx"
    ver:
      regex: 'curl (.*) \('
  - name: ventoy
    type: git
    repo: ventoy/Ventoy
    incl:
      - linux
      - tar.gz
    inst:
      - mkdir -p "{{ tool.opt_dir }}/{{ tool.name }}"
      - tar --strip-components=2 -C "{{ tool.opt_dir }}/{{ tool.name }}" -xvf "{{ tool.pkg_dir }}/{{ tool.pkg_name }}"
    ver:
      type: file
      name: "{{ tool.opt_dir }}/{{ tool.name }}/{{ tool.name }}/version"
  - name: ytcast
    type: git
    repo: MarcoLucidi01/ytcast
    incl:
      - linux-amd64
      - tar.gz
    inst:
      - tar --strip-components=1 -C "{{ tool.bin_dir }}" -xvf "{{ tool.pkg_dir }}/{{ tool.pkg_name }}" --wildcards --no-anchored "*/{{ tool.name }}"
    ver:
      name: "{{ tool.name }} -v"

  - name: usbimager
    type: custom
    url: https://gitlab.com/bztsrc/usbimager/raw/master/README.md
    package: "-x86_64-linux-gtk.zip"
    inst:
      - sudo unzip -o "{{ tool.pkg_dir }}/{{ tool.pkg_name }}" -d /usr

